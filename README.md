# 区块链操作日志记录本

一个个人区块链操作日志记录系统，帮助用户追踪和管理自己的区块链投资、DEFI操作和空投参与情况。

## 功能特性

### 🎯 仓位展示
- **买入/卖出记录**: 记录每次Token的买入和卖出操作
- **成本计算**: 自动计算每个Token的平均成本价格
- **仓位汇总**: 显示当前持仓的Token数量和总价值
- **饼状图展示**: 使用Chart.js展示各Token的仓位占比
- **操作历史**: 查看完整的交易操作记录

### 🏦 DEFI操作
- **多平台支持**: 记录在不同DEFI平台的操作
- **操作类型**: 支持质押、解质押、借贷、还款、流动性提供/移除等
- **收益率追踪**: 记录年化收益率和奖励Token信息
- **平台汇总**: 按平台和Token汇总DEFI操作
- **价值分布饼状图**: 使用Chart.js展示各DEFI项目的USDT价值占比
- **智能排序功能**: 支持按USDT价值、APR、每日收益、退出时间等字段排序
- **默认价值排序**: 自动按USDT价值倒序排列，优先显示价值最高的项目

### 🎁 空投参与
- **项目追踪**: 记录参与的空投项目信息
- **状态管理**: 跟踪空投项目的进行状态（进行中/已完成/失败）
- **奖励记录**: 记录预期和实际获得的奖励数量
- **要求记录**: 记录参与空投的具体要求

## 技术架构

### 前端
- **HTML5**: 语义化标签，响应式设计
- **CSS3**: 现代化样式，渐变背景，动画效果，排序按钮样式
- **JavaScript ES6+**: 模块化代码，异步操作，Chart.js图表
- **图表功能**: 仓位占比饼状图、DEFI项目价值分布饼状图
- **排序系统**: 智能表格排序，支持多字段排序和方向切换

### 后端
- **Node.js**: 服务器运行环境
- **Express.js**: Web应用框架
- **MySQL**: 关系型数据库
- **RESTful API**: 标准化的API接口

### 数据库设计
- **仓位操作表**: 记录买入/卖出操作
- **DEFI操作表**: 记录DEFI平台操作
- **空投参与表**: 记录空投项目参与情况

## 安装和运行

### 环境要求
- Node.js 14.0+
- MySQL 5.7+
- 现代浏览器支持

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd hackathon
```

2. **安装依赖**
```bash
npm install
```

3. **配置数据库**
```bash
# 创建MySQL数据库
mysql -u root -p < database/schema.sql
```

4. **配置环境变量**
```bash
# 复制环境配置示例文件
cp .env.example .env

# 编辑.env文件，配置数据库连接信息
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=blockchain_log
PORT=3000
```

5. **启动服务器**
```bash
# 开发模式（自动重启）
npm run dev

# 生产模式
npm start
```

6. **访问应用**
打开浏览器访问: http://localhost:3000

## 使用说明

### 添加仓位操作
1. 点击"仓位展示"标签页
2. 点击"添加操作记录"按钮
3. 填写操作信息：
   - 操作类型：买入/卖出
   - Token符号和名称
   - 数量和价格
   - 操作原因
4. 提交表单

### 查看仓位汇总
- 系统自动计算每个Token的：
  - 净持仓数量
  - 持仓总价值
  - 平均成本价格
- 饼状图显示各Token的仓位占比

### 查看DEFI汇总
- 系统自动计算每个DEFI项目的：
  - 净质押/借款数量
  - USDT价值
  - 平均年化收益率
  - 每日收益
- **价值分布饼状图**: 按USDT价值倒序显示各项目占比
- **智能排序表格**: 支持按以下字段排序：
  - 价值USDT（默认倒序）
  - APR年化收益率
  - 每日收益
  - 退出时间
- 点击列标题的排序按钮可切换排序方向和字段

### 添加DEFI操作
1. 点击"DEFI"标签页
2. 点击"添加DEFI记录"按钮
3. 填写平台和操作信息
4. 记录年化收益率和奖励Token

### 管理空投参与
1. 点击"空投参与"标签页
2. 添加新的空投项目
3. 跟踪项目状态和奖励情况
4. 更新项目进展

## API接口

### 仓位相关
- `GET /api/position` - 获取所有仓位操作记录
- `POST /api/position` - 添加新的仓位操作
- `GET /api/position/summary` - 获取仓位汇总信息
- `GET /api/position/token/:symbol` - 获取特定Token的操作历史
- `DELETE /api/position/:id` - 删除仓位操作记录

### DEFI相关
- `GET /api/defi` - 获取所有DEFI操作记录
- `POST /api/defi` - 添加新的DEFI操作
- `GET /api/defi/summary` - 获取DEFI汇总信息
- `GET /api/defi/platform/:platform` - 获取特定平台的DEFI操作
- `DELETE /api/defi/:id` - 删除DEFI操作记录

### 空投相关
- `GET /api/airdrop` - 获取所有空投参与记录
- `POST /api/airdrop` - 添加新的空投参与
- `GET /api/airdrop/summary` - 获取空投汇总信息
- `PUT /api/airdrop/:id/status` - 更新空投状态
- `GET /api/airdrop/status/:status` - 获取特定状态的空投记录
- `DELETE /api/airdrop/:id` - 删除空投参与记录

## 项目结构

```
hackathon/
├── frontend/              # 前端文件
│   ├── index.html        # 主页面（包含DEFI饼状图和排序功能）
│   ├── css/
│   │   ├── style.css     # 样式文件（包含排序按钮和图表样式）
│   │   └── bootstrap-icons.css  # 图标库
│   └── js/
│       └── app.js        # 应用逻辑（包含图表和排序功能）
├── backend/               # 后端文件
│   ├── server.js         # 主服务器
│   ├── config/
│   │   └── database.js   # 数据库配置
│   └── routes/           # 路由文件
│       ├── position.js   # 仓位路由
│       ├── defi.js       # DEFI路由
│       └── airdrop.js    # 空投路由
├── database/
│   └── schema.sql        # 数据库结构
├── package.json           # 项目配置
└── README.md             # 项目说明
```

## 开发说明

### 代码规范
- 使用ES6+语法
- 遵循RESTful API设计原则
- 统一的错误处理和响应格式
- 响应式设计，支持移动端

### 新增功能特性
- **DEFI饼状图**: 使用Chart.js实现，支持响应式设计和动画效果
- **智能排序系统**: 支持多字段排序，自动状态管理，图标动态更新
- **数据同步**: 饼状图和表格数据保持同步，排序后饼状图自动更新
- **用户体验**: 悬停效果、动画过渡、清晰的视觉反馈

### 安全考虑
- SQL注入防护（使用参数化查询）
- CORS配置
- 输入验证和清理
- 错误信息不暴露系统细节

### 性能优化
- 数据库连接池
- 前端资源压缩
- 异步操作处理
- 响应式图片和布局

## 贡献指南

1. Fork项目
2. 创建功能分支
3. 提交更改
4. 推送到分支
5. 创建Pull Request

## 许可证

MIT License

## 联系方式

如有问题或建议，请提交Issue或联系开发者。

## 版本更新

### v1.1.0 (最新)
- ✨ 新增DEFI项目价值分布饼状图
- ✨ 新增DEFI汇总表格智能排序功能
- ✨ 支持按USDT价值、APR、每日收益、退出时间排序
- ✨ 默认按USDT价值倒序排列，优先显示重要项目
- ✨ 优化用户体验，添加排序按钮样式和动画效果
- 🔧 修复表格排序时机问题，确保数据完整性

### v1.0.0
- 🎯 基础仓位管理功能
- 🏦 DEFI操作记录功能
- 🎁 空投参与追踪功能
- 📊 仓位占比饼状图

---

**注意**: 这是一个个人使用的工具，请根据实际需求调整配置和功能。投资有风险，请谨慎决策。
